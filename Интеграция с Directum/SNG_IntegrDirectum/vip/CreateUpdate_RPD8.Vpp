function CreateUpdate_RPD8(_cRec : comp): boolean; {
  if getfirst Titledoc where ((_cRec == Titledoc.nrec)) <> tsOK {
    if _isDebug{
        message('Не найден приказ c Titledoc.nrec = ' + string(_cRec, 0, 0),error)
      }
    exit;
  }
  if(getfirst partdoc where ((titledoc.nrec == partdoc.CDOC)) and Partdoc.TYPEOPER = 8 ) <> tsOK {
    if _isDebug{
        message('В приказе нет разделов "Увольнение" (РПД 8)',error)
      }
    exit;
  }
// gettunes;
   var methodstr : string = sgettune('DirectumIntegration_RPD8');

  _loop partdoc where ((titledoc.nrec == partdoc.CDOC)) and Partdoc.TYPEOPER = 8 {
    _loop contdoc where ((partdoc.nrec == contdoc.CPART)) {
      if getfirst PERSONS where ((CONTDOC.PERSON == PERSONS.nrec)) <> tsOK then {
         if _isDebug{
            message('В приказе не нашли сотрудника (CONTDOC.PERSON == PERSONS.nrec) CONTDOC.PERSON = ' + string(CONTDOC.PERSON,0,0),error)
          }
        continue;
      }

      if getfirst Catalogs_podr where ((CONTDOC.CDOPREF == Catalogs_podr.nrec)) <> tsOK  then {
        if _isDebug{
            message('В приказе не нашли подразделение (CONTDOC.CDOPREF == Catalogs_podr.nrec) CONTDOC.CDOPREF = ' + string(CONTDOC.CDOPREF,0,0),error)
          }
         continue;
        }
      if getfirst appointments where ((contdoc.CSTR == appointments.nrec)) <> tsOk then  {
           if _isDebug{
            message('В приказе не нашли назначение назначение (contdoc.CSTR == appointments.nrec) contdoc.CSTR = ' + string(contdoc.CSTR,0,0),error)
          }
          continue;
        }

      if getfirst STAFFSTRUCT where ((appointments.STAFFSTR == STAFFSTRUCT.nrec)) <> tsOK  then {
         if _isDebug{
            message('В назначении не нашли ШР (appointments.STAFFSTR == STAFFSTRUCT.nrec) appointments.STAFFSTR = ' + string(appointments.STAFFSTR,0,0),error)
          }
         continue;
        }


    /*
      Структуру не дали... сказали делать просто чтобы было.
      Потом дадут структуру  и "ЧУТЬ ЧУТЬ" надо будет переделать 0_о
    */
   var  m_service : TPtr = HttpConnect_CreateEx('http://ya.ru', '', '', true);
   var JSONObj : TPtr = HttpConnect_JsonObjectCreate(m_service);
/*Заголовок взял пока что из РПД6*/
    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'HRCode', string(TYPEPR.nrec,0,0));
    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'HRCodeRPD',string(CONTDOC.NREC,0,0));
    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'HRCodeEvent',co_unknown_value); // поле CATALOGS.CODE при CATALOGS.CPARENT=CATALOGS.NREC, где CATALOGS.NREC - значение для записи CATALOGS.SYSCODE=-31699
    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'HRCodeAbsence', string(KLOTPUSK.KOTPUS));
    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'HRCodeReason',if(getfirst cat_search where ((PARTDOC.CPREF == cat_search.NREC)) = tsOK, string(cat_search.NREC,0,0),''));
    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'Employees', PERSONS.TABNMB);
    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'DissmissalDate', _SNG_IntegrDirectum_out_base.SetDateToHeader(APPOINTMENTS.DORDERDISDATE) );
    HttpConnect_JsonObjectAddInteger(m_service, JSONObj, 'IdMainDoc', 0);
    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'Author', _SNG_IntegrDirectum_out_base.GetDocUserTabN ); // тут по идее _SNG_IntegrDirectum_out_base.GetDocUserTabN(с каким то параметром)
    HttpConnect_JsonObjectAddBoolean(m_service, JSONObj, 'IsArhive',False);

        var JSONObj_Array : TPtr = HttpConnect_JsonArrayCreate(m_service);
     mylog(' start JSONObj_Array');

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'NAME_ORG_SHORT', sgettune('myorg'));
    var _NAME_ORG_SHORT: string = sgettune('myorg');
      #addArrayElementString(NAME_ORG_SHORT)
//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'NAME'  , getpodrunder('0000', Catalogs_podr.nrec, Catalogs_podr.cParent));
    var _NAME: string = getpodrunder('0000', Catalogs_podr.nrec, Catalogs_podr.cParent);
      #addArrayElementString(NAME)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PODR'  , if(Catalogs_podr.longname = '', Catalogs_podr.name,Catalogs_podr.longname));
    var _PODR: string = if(Catalogs_podr.longname = '', Catalogs_podr.name,Catalogs_podr.longname);
      #addArrayElementString(PODR)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'NDOC'  , TITLEDOC.DOCNMB);
    var _NDOC: string = TITLEDOC.DOCNMB;
      #addArrayElementString(NDOC)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'DDOC'  , datetostr(TITLEDOC.DOCDATE, co_formatdatetostr));
    var _DDOC : string = datetostr(TITLEDOC.DOCDATE, co_formatdatetostr);
      #addArrayElementString(DDOC)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'FIO'   , PERSONS.FIO);
    var _FIO : string = PERSONS.FIO;
      #addArrayElementString(FIO)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PERNR' , string(PERSONS.TABNMB));
    var _PERNR: string = string(PERSONS.TABNMB);
      #addArrayElementString(PERNR)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'SHDOL' , STAFFSTRUCT.SNAMEST);
    var _SHDOL: string = STAFFSTRUCT.SNAMEST;
      #addArrayElementString(SHDOL)

//    HttpConnect_JsonObjectAddInteger(m_service, JSONObj, 'UVO_DAY', day(CONTDOC.DDISDATE));
    var _UVO_DAY: string = string(day(CONTDOC.DDISDATE));
      #addArrayElementString(UVO_DAY)

//    HttpConnect_JsonObjectAddInteger(m_service, JSONObj, 'UVO_MONTH', month(CONTDOC.DDISDATE));
    var _UVO_MONTH: string = string(month(CONTDOC.DDISDATE));
      #addArrayElementString(UVO_MONTH)

//    HttpConnect_JsonObjectAddInteger(m_service, JSONObj, 'UVO_YEAR', year(CONTDOC.DDISDATE));
    var _UVO_YEAR: string = string(year(CONTDOC.DDISDATE));
      #addArrayElementString(UVO_YEAR)

    /*
    трудовой договор
    */
    if getfirst SpAllStaff_TD where ((cgAllStaffContract == SpAllStaff_TD.wNoCon
                                     and Persons.NREC   == SpAllStaff_TD.cBaseT)) = tsOK {
//              _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'CTNUM' , SpAllStaff_TD.ResString[1]);
              var _CTNUM: string = SpAllStaff_TD.ResString[1];
                #addArrayElementString(CTNUM)

//                HttpConnect_JsonObjectAddInteger(m_service, JSONObj, 'TD_DAY', day(SpAllStaff_TD.RESDATE[2]));
              var _TD_DAY: string = string(day(SpAllStaff_TD.RESDATE[2]));
                #addArrayElementString(TD_DAY)

//                HttpConnect_JsonObjectAddInteger(m_service, JSONObj, 'TD_MONTH', month(SpAllStaff_TD.RESDATE[2]));
              var _TD_MONTH: string = string(month(SpAllStaff_TD.RESDATE[2]));
                #addArrayElementString(TD_MONTH)

//                 HttpConnect_JsonObjectAddInteger(m_service, JSONObj, 'TD_YEAR', year(SpAllStaff_TD.RESDATE[2]));
              var _TD_YEAR: string = string(year(SpAllStaff_TD.RESDATE[2]));
                #addArrayElementString(TD_YEAR)

       }

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'OBST','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _OBST: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(OBST)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PRICH1','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _PRICH1: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(PRICH1)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PRICH2','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _PRICH2: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(PRICH2)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PRICH3','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _PRICH3: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(PRICH3)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PRICH4','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _PRICH4: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(PRICH4)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PRICH5','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _PRICH5: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(PRICH5)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PRICH6','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _PRICH6: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(PRICH6)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'OSN2','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _OSN2: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(OSN2)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'TEXT_AVANS1','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _TEXT_AVANS1: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(TEXT_AVANS1)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'AVANS','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _AVANS: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(AVANS)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'TEXT_AVANS2','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _TEXT_AVANS2: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(TEXT_AVANS2)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'TEXT_NAVANS1','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _NAVANS: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(NAVANS)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'TEXT_NAVANS1','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _TEXT_NAVANS1: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(TEXT_NAVANS1)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'TEXT_NAVANS2','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _TEXT_NAVANS2: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(TEXT_NAVANS2)

//    _SNG_IntegrDirectum_out_base.my_HttpConnect_JsonObjectAddString(m_service, JSONObj, 'PERIOD','НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ');
    var _PERIOD: string = 'НЕ СКАЗАЛИ КАК ЗАПОЛНЯТЬ';
      #addArrayElementString(PERIOD)

    HttpConnect_JsonObjectAddObject(m_service, JSONObj, 'Content', JSONObj_Array);

     var lResponse : tptr;
     if _SNG_IntegrDirectum_out_base.DoRequest(methodstr, JSONObj, lResponse) {
        /*чтот то надо сделать*/
        var JSONResponse : TPtr = HttpConnect_JSONObjectByLongString(m_service, lResponse);
          if upcase(HttpConnect_JsonObjectValueByName(m_service,JSONResponse,'TypeMessage')) <> upcase('Success') {
              if _isDebug{
                 message('DirectunRX вернул ошибку: ' +
                      ''#13''+ HttpConnect_JsonObjectValueByName(m_service,JSONResponse,'Message'),error);
                }
           result := false;
         }
         else {

              var Id : string = HttpConnect_JsonObjectValueByName(m_service,JSONResponse,'Id');
              _SNG_IntegrDirectum_out_base.SetIdDirectRx(coTitleDoc,Titledoc.nrec,Id);

              if _isDebug{
                 message('DirectunRX приказ успешно передан: Id = "' + Id+'"'+
                      ''#13''+ HttpConnect_JsonObjectValueByName(m_service,JSONResponse,'Message'));
                }

           result := true;
         }

       }
       else {
         result := false;
       }


   // var jsonResponse: TPtr = HttpConnect_JSONObjectByLongString(httpCon, lResponse);

    HttpConnect_JSONObjectDestroy(m_service,JSONObj);
    HttpConnect_Free(m_service);
   }
  }
}   //end function CreateUpdate_RPD1(_cRec : comp): string; {
