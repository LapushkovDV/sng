/*************************************************************************************************\
* Наименование: Свод по Ведомостям премирования                                                            *
* Контур/Модуль: Кадры                                                                            *
* Примечание:                                                                                     *
*                                                                                                 *
* Вид работы  |Номер         |Дата    |Исполнитель              |Проект                           *
* ----------------------------------------------------------------------------------------------- *
* Разработка  |#794          |26/02/18|Кириллов Э.П.            |НПО Энергомаш                    *
\*************************************************************************************************/
#include ShowKau.Vpp
const
 cgFilter_Raise =5;
 cgFilter_Podr  =6;
 cgFilter_Kateg =7;
 cgFilter_Pers  =8;
 cgFilter_Post  =9;
 //-- группировки
 cg_s_Len_a_gr = 9;
 //=====================
 cg_s_code_Department     = 01;
 cg_s_name_Department     = 'Подразделение';
 cg_s_code_Depart_V       = 02;
 cg_s_name_Depart_V       = 'Подразделение ведомости';
 cg_s_code_Kateg          = 03;
 cg_s_name_Kateg          = 'Категория сотрудников';
 cg_s_code_Post           = 04;
 cg_s_name_Post           = 'Должность';
 cg_s_code_Year           = 05;
 cg_s_name_Year           = 'Год';
 cg_s_code_quarter        = 06;
 cg_s_name_quarter        = 'квартал';
 cg_s_code_month          = 07;
 cg_s_name_month          = 'Месяц';
 cg_s_code_Pers           = 08;
 cg_s_name_Pers           = 'Сотрудник';
 cg_s_code_cex            = 09;
 cg_s_name_cex            = 'цех';
end;


//--------------------------------
var a_GroupRep     : array [1..cg_s_Len_a_gr] of word;
var a_GroupIE      : array [1..cg_s_Len_a_gr] of word;
var sReportGRName  : array [1..cg_s_Len_a_gr] of string;
var sReportGRCode  : array [1..cg_s_Len_a_gr] of string;
var sReportGRNrec  : array [1..cg_s_Len_a_gr] of comp;
var sReportGRTBL   : array [1..cg_s_Len_a_gr] of word;
var sReportAgr     : array [1..100] of word;


//=======================================
// Проверить выбрана Группировка
//=======================================
Function CheckGroupMas(wNoGr:word):Word; Cacheable;
var iii   :word;
{
   CheckGroupMas:=0;
   for(iii:=1;iii<=word(cg_s_Len_a_gr);iii:=iii+1)
   { if (a_GroupRep[iii]=wNoGr)
     { CheckGroupMas:=iii;
       exit;
     }
   }
} //Procedure CheckGroupMas

//=======================================
//Наименование уровня
//=======================================
Function GetLevelName(icg:word):string;
{ Result:='';
  case icg of
  cg_s_code_Department  :Result:= cg_s_name_Department  ;//'Подразделение';
  cg_s_code_Depart_V    :Result:= cg_s_name_Depart_V    ;//'Подразделение ведомости';
  cg_s_code_Kateg       :Result:= cg_s_name_Kateg       ;//'Категория сотрудников';
  cg_s_code_Post        :Result:= cg_s_name_Post        ;//'Должность';
  cg_s_code_Year        :Result:= cg_s_name_Year        ;//'Год';
  cg_s_code_quarter     :Result:= cg_s_name_quarter     ;//'квартал';
  cg_s_code_month       :Result:= cg_s_name_month       ;//'Месяц';
  cg_s_code_Pers        :Result:= cg_s_name_Pers        ;//'Сотрудник';
  cg_s_code_cex         :Result:= cg_s_name_cex         ;//'цех';
  end;
}//Function GetLevelName(icg):string;

//=======================================
//Имя для уровня
//=======================================
Function GetGroupNameLevel(icg:word;sName:String):String;
{  Result:=if(sName='',UpCase(GetLevelName(icg) )+': нет',sName);
} //Function GetGroupNameLevelScud


//=======================================
//Цвет для уровня
//=======================================
Function GetColorLevel(icg:Integer):Longint;
{
/*
0FF0000h; //синий
000FF00h; //зеленый
00000FFh; //красный
*/
    case icg of
    cg_s_code_Department: Result:=0FFFFAAh; //Бледно синий
    // :=0DDDDDDh; //Бледно серый
    // :=0CCFFCCh; //Бледно зеленый
    //:=0AAFFFFh; //Бледно желтый
    //:=0FFAAFFh; //Бледно розовый
    //:=0FFDDDDh; //Бледно фиолетовый
    else  GetColorLevel:=0DDDDDDh; //Бледно серый
    end;
} //Function GetColorLevel
//=======================================
// Установка массива Группировки
//=======================================
Procedure MySetGroupMas(tmpStr:String);
var iii   :word;
    _sLevel:string;
{  for(iii:=1;iii<=word(cg_s_Len_a_gr);iii:=iii+1)
   { a_GroupRep[iii]:=0;
     a_GroupIE [iii]:=0;
   }
   for(iii:=1;iii<=word(cg_s_Len_a_gr);iii:=iii+1)
   { if(tmpStr<>'')
     { if(InStr('/',tmpStr)>0)
       { _sLevel:=SubStr(tmpStr, 1, InStr('/',tmpStr)-1);
         tmpStr:=SubStr(tmpStr, InStr('/',tmpStr)+1, Length(tmpStr));
       }
       else
       { _sLevel:=tmpStr;
         tmpStr:='';
       }
       a_GroupRep[iii]:=word(ParseWord(_sLevel,1,':'));
       a_GroupIE [iii]:=word(ParseWord(_sLevel,2,':'));
     }
     else break;
   } //for
} //Procedure MySetGroupMas

